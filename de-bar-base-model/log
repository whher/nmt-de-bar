[2022-08-25:15:31:45:INFO:sockeye.utils:log_sockeye_version] Sockeye: 3.1.20, commit unknown, path /home/jovyan/sockeye/sockeye/__init__.py
[2022-08-25:15:31:45:INFO:sockeye.utils:log_torch_version] PyTorch: 1.11.0+cu102 (/opt/conda/lib/python3.9/site-packages/torch/__init__.py)
[2022-08-25:15:31:45:INFO:sockeye.utils:log_basic_info] Command: /home/jovyan/sockeye/sockeye/train.py -d de-bar/parallel/train_data -vs de-bar/parallel/test.BPE.src -vt de-bar/parallel/test.BPE.tgt --max-seq-len 90 --decode-and-evaluate 500 -o de-bar-base-model --shared-vocab --num-layers 6 --max-num-checkpoint-not-improved 1
[2022-08-25:15:31:45:INFO:sockeye.utils:log_basic_info] Arguments: Namespace(config=None, source=None, source_factors=[], source_factors_use_source_vocab=[], target_factors=[], target_factors_use_target_vocab=[], target=None, prepared_data='de-bar/parallel/train_data', validation_source='de-bar/parallel/test.BPE.src', validation_source_factors=[], validation_target='de-bar/parallel/test.BPE.tgt', validation_target_factors=[], no_bucketing=False, bucket_width=8, bucket_scaling=False, max_seq_len=(90, 90), source_vocab=None, target_vocab=None, source_factor_vocabs=[], target_factor_vocabs=[], shared_vocab=True, num_words=(0, 0), word_min_count=(1, 1), pad_vocab_to_multiple_of=8, output='de-bar-base-model', overwrite_output=False, params=None, allow_missing_params=False, ignore_extra_params=False, encoder='transformer', decoder='transformer', num_layers=(6, 6), transformer_model_size=(512, 512), transformer_attention_heads=(8, 8), transformer_feed_forward_num_hidden=(2048, 2048), transformer_feed_forward_use_glu=False, transformer_activation_type=('relu', 'relu'), transformer_positional_embedding_type='fixed', transformer_preprocess=('n', 'n'), transformer_postprocess=('dr', 'dr'), lhuc=None, num_embed=(None, None), source_factors_num_embed=[], target_factors_num_embed=[], source_factors_combine=[], target_factors_combine=[], source_factors_share_embedding=[], target_factors_share_embedding=[], weight_tying_type='src_trg_softmax', dtype='float32', clamp_to_dtype=False, amp=False, apex_amp=False, neural_vocab_selection=None, neural_vocab_selection_block_loss=False, batch_size=4096, batch_type='word', batch_sentences_multiple_of=8, update_interval=1, label_smoothing=0.1, label_smoothing_impl='mxnet', length_task=None, length_task_weight=1.0, length_task_layers=1, bow_task_weight=1.0, bow_task_pos_weight=10, target_factors_weight=[1.0], optimized_metric='perplexity', checkpoint_interval=4000, min_samples=None, max_samples=None, min_updates=None, max_updates=None, max_seconds=None, max_checkpoints=None, max_num_checkpoint_not_improved=1, checkpoint_improvement_threshold=0.0, min_num_epochs=None, max_num_epochs=None, embed_dropout=(0.0, 0.0), transformer_dropout_attention=(0.1, 0.1), transformer_dropout_act=(0.1, 0.1), transformer_dropout_prepost=(0.1, 0.1), optimizer='adam', optimizer_betas=(0.9, 0.999), optimizer_eps=1e-08, dist=False, initial_learning_rate=0.0002, weight_decay=0.0, momentum=0.0, gradient_clipping_threshold=1.0, gradient_clipping_type='none', learning_rate_scheduler_type='plateau-reduce', learning_rate_reduce_factor=0.9, learning_rate_reduce_num_not_improved=8, learning_rate_warmup=0, no_reload_on_learning_rate_reduce=False, fixed_param_strategy=None, fixed_param_names=[], local_rank=None, deepspeed_fp16=False, deepspeed_bf16=False, decode_and_evaluate=500, stop_training_on_decoder_failure=False, seed=1, keep_last_params=-1, keep_initializations=False, cache_last_best_params=0, cache_strategy='best', cache_metric='perplexity', dry_run=False, device_id=0, use_cpu=False, env=None, quiet=False, quiet_secondary_workers=False, no_logfile=False, loglevel='INFO', loglevel_secondary_workers='INFO')
[2022-08-25:15:31:45:INFO:__main__:train] Adjusting maximum length to reserve space for a BOS/EOS marker. New maximum length: (91, 91)
[2022-08-25:15:31:45:INFO:__main__:train] Training Device: cuda:0
[2022-08-25:15:31:45:INFO:sockeye.utils:seed_rngs] Random seed: 1
[2022-08-25:15:31:45:INFO:sockeye.utils:seed_rngs] PyTorch seed: 1
[2022-08-25:15:31:45:INFO:sockeye.data_io:get_prepared_data_iters] ===============================
[2022-08-25:15:31:45:INFO:sockeye.data_io:get_prepared_data_iters] Creating training data iterator
[2022-08-25:15:31:45:INFO:sockeye.data_io:get_prepared_data_iters] ===============================
[2022-08-25:15:31:45:INFO:sockeye.vocab:vocab_from_json] Vocabulary (1824 words) loaded from "de-bar/parallel/train_data/vocab.src.0.json"
[2022-08-25:15:31:45:INFO:sockeye.vocab:vocab_from_json] Vocabulary (1824 words) loaded from "de-bar/parallel/train_data/vocab.trg.0.json"
[2022-08-25:15:31:45:INFO:sockeye.data_io:log] Tokens: source 851505 target 872230
[2022-08-25:15:31:45:INFO:sockeye.data_io:log] Number of <unk> tokens: source 0 target 0
[2022-08-25:15:31:45:INFO:sockeye.data_io:log] Vocabulary coverage: source 100% target 100%
[2022-08-25:15:31:45:INFO:sockeye.data_io:log] 33812 sequences across 12 buckets
[2022-08-25:15:31:45:INFO:sockeye.data_io:log] 0 sequences did not fit into buckets and were discarded
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (8, 8): 2911 samples in 5 batches of 680, ~4110.8 target tokens/batch, trg/src length ratio: 1.01 (+-0.27)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (16, 16): 6141 samples in 18 batches of 360, ~4140.4 target tokens/batch, trg/src length ratio: 1.07 (+-0.37)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (24, 24): 5359 samples in 25 batches of 216, ~4133.6 target tokens/batch, trg/src length ratio: 1.04 (+-0.32)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (32, 32): 5364 samples in 36 batches of 152, ~4117.3 target tokens/batch, trg/src length ratio: 1.02 (+-0.21)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (40, 40): 8727 samples in 78 batches of 112, ~3965.0 target tokens/batch, trg/src length ratio: 1.04 (+-0.17)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (48, 48): 4806 samples in 51 batches of 96, ~4044.5 target tokens/batch, trg/src length ratio: 1.07 (+-0.17)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (56, 56): 476 samples in 6 batches of 88, ~4271.3 target tokens/batch, trg/src length ratio: 1.05 (+-0.22)
[2022-08-25:15:31:45:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (64, 64): 28 samples in 1 batches of 72, ~4145.1 target tokens/batch, trg/src length ratio: 0.98 (+-0.07)
[2022-08-25:15:31:45:INFO:sockeye.data_io:_load_shard] Loading shard de-bar/parallel/train_data/shard.00000.
[2022-08-25:15:31:46:INFO:sockeye.data_io:get_validation_data_iter] =================================
[2022-08-25:15:31:46:INFO:sockeye.data_io:get_validation_data_iter] Creating validation data iterator
[2022-08-25:15:31:46:INFO:sockeye.data_io:get_validation_data_iter] =================================
[2022-08-25:15:31:46:INFO:sockeye.data_io:analyze_sequence_lengths] 8454 sequences of maximum length (96, 96) in '/home/jovyan/sockeye/de-bar/parallel/test.BPE.src' and '/home/jovyan/sockeye/de-bar/parallel/test.BPE.tgt'.
[2022-08-25:15:31:46:INFO:sockeye.data_io:analyze_sequence_lengths] Mean training target/source length ratio: 1.04 (+-0.26)
[2022-08-25:15:31:46:INFO:sockeye.data_io:log] Tokens: source 215079 target 219686
[2022-08-25:15:31:46:INFO:sockeye.data_io:log] Number of <unk> tokens: source 81 target 83
[2022-08-25:15:31:46:INFO:sockeye.data_io:log] Vocabulary coverage: source 100% target 100%
[2022-08-25:15:31:46:INFO:sockeye.data_io:log] 8454 sequences across 12 buckets
[2022-08-25:15:31:46:INFO:sockeye.data_io:log] 0 sequences did not fit into buckets and were discarded
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (8, 8): 725 samples in 2 batches of 680, ~4110.8 target tokens/batch, trg/src length ratio: 1.03 (+-0.27)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (16, 16): 1542 samples in 5 batches of 360, ~4140.4 target tokens/batch, trg/src length ratio: 1.08 (+-0.38)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (24, 24): 1299 samples in 7 batches of 216, ~4133.6 target tokens/batch, trg/src length ratio: 1.03 (+-0.33)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (32, 32): 1300 samples in 9 batches of 152, ~4117.3 target tokens/batch, trg/src length ratio: 1.02 (+-0.21)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (40, 40): 2141 samples in 20 batches of 112, ~3965.0 target tokens/batch, trg/src length ratio: 1.04 (+-0.16)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (48, 48): 1299 samples in 14 batches of 96, ~4044.5 target tokens/batch, trg/src length ratio: 1.06 (+-0.17)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (56, 56): 143 samples in 2 batches of 88, ~4271.3 target tokens/batch, trg/src length ratio: 1.03 (+-0.22)
[2022-08-25:15:31:46:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (64, 64): 5 samples in 1 batches of 72, ~4145.1 target tokens/batch, trg/src length ratio: 0.92 (+-0.13)
[2022-08-25:15:31:46:INFO:sockeye.data_io:load] Created bucketed parallel data set. Introduced padding: source=17.1% target=15.4%)
[2022-08-25:15:31:46:INFO:__main__:train] Maximum source length determined by prepared data. Using 96 instead of 91
[2022-08-25:15:31:46:INFO:__main__:train] Maximum target length determined by prepared data. Using 96 instead of 91
[2022-08-25:15:31:46:INFO:sockeye.vocab:vocab_to_json] Vocabulary saved to "/home/jovyan/sockeye/de-bar-base-model/vocab.src.0.json"
[2022-08-25:15:31:46:INFO:sockeye.vocab:vocab_to_json] Vocabulary saved to "/home/jovyan/sockeye/de-bar-base-model/vocab.trg.0.json"
[2022-08-25:15:31:46:INFO:__main__:train] Vocabulary sizes: source=[1824] target=[1824]
[2022-08-25:15:31:46:INFO:__main__:get_num_embed] Source embedding size was not set it will automatically be adjusted to match the Transformer source model size (512).
[2022-08-25:15:31:46:INFO:__main__:get_num_embed] Target embedding size was not set it will automatically be adjusted to match the Transformer target model size (512).
[2022-08-25:15:31:46:INFO:__main__:create_optimizer_config] OptimizerConfig(name='adam', running_on_gpu=True, lr=0.0002, betas=(0.9, 0.999), eps=1e-08, weight_decay=0.0, momentum=0.0, gradient_clipping_type='none', gradient_clipping_threshold=1.0, update_interval=1)
[2022-08-25:15:31:46:INFO:__main__:create_optimizer_config] Gradient accumulation over 1 batch(es) by 1 worker(s). Effective batch size: 4096
[2022-08-25:15:31:46:INFO:sockeye.model:__init__] ModelConfig(config_data=DataConfig(data_statistics=DataStatistics(num_sents=33812, num_discarded=0, num_tokens_source=851505, num_tokens_target=872230, num_unks_source=0, num_unks_target=0, max_observed_len_source=62, max_observed_len_target=62, size_vocab_source=1824, size_vocab_target=1824, length_ratio_mean=1.0452076898259843, length_ratio_std=0.2569976661597348, buckets=[(8, 8), (16, 16), (24, 24), (32, 32), (40, 40), (48, 48), (56, 56), (64, 64), (72, 72), (80, 80), (88, 88), (96, 96)], num_sents_per_bucket=[2911, 6141, 5359, 5364, 8727, 4806, 476, 28, 0, 0, 0, 0], average_len_target_per_bucket=[6.045345242184824, 11.501221299462642, 19.136965851838035, 27.087434750186386, 35.402200068752144, 42.13066999583858, 48.537815126050404, 57.57142857142857, None, None, None, None], length_ratio_stats_per_bucket=[(1.0113338567993342, 0.26910236002212695), (1.0749749603560077, 0.36538334776507125), (1.0385304702928602, 0.31762472156054533), (1.0179573464915883, 0.20601031608992504), (1.0447543149211593, 0.17034130647140222), (1.0662210413917244, 0.17174876254447757), (1.0505112291795995, 0.22397394222214115), (0.9809909461421835, 0.06857465328691922), (None, None), (None, None), (None, None), (None, None)]), max_seq_len_source=96, max_seq_len_target=96, num_source_factors=1, num_target_factors=1), vocab_source_size=1824, vocab_target_size=1824, config_embed_source=EmbeddingConfig(vocab_size=1824, num_embed=512, dropout=0.0, num_factors=1, factor_configs=None, allow_sparse_grad=False), config_embed_target=EmbeddingConfig(vocab_size=1824, num_embed=512, dropout=0.0, num_factors=1, factor_configs=None, allow_sparse_grad=False), config_encoder=TransformerConfig(model_size=512, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.1, dropout_act=0.1, dropout_prepost=0.1, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=96, max_seq_len_target=96, decoder_type='transformer', use_lhuc=False, depth_key_value=512, use_glu=False), config_decoder=TransformerConfig(model_size=512, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.1, dropout_act=0.1, dropout_prepost=0.1, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=96, max_seq_len_target=96, decoder_type='transformer', use_lhuc=False, depth_key_value=512, use_glu=False), config_length_task=None, weight_tying_type='src_trg_softmax', lhuc=False, dtype='float32', neural_vocab_selection=None, neural_vocab_selection_block_loss=False)
[2022-08-25:15:31:48:INFO:sockeye.utils:log_parameters] # of parameters: 45137696 | trainable: 45039392 (99.78%) | shared: 933888 (2.07%) | fixed: 98304 (0.22%)
[2022-08-25:15:31:48:INFO:sockeye.utils:log_parameters] Trainable parameters: 
['embedding_source.embedding [(1824, 512), float32]',
 'embedding_target.embedding [(1824, 512), float32]',
 'encoder.layers.0.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.0.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.0.self_attention.ff_out [(512, 512), float32]',
 'encoder.layers.0.self_attention.ff_in [(1536, 512), float32]',
 'encoder.layers.0.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.0.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.0.ff.ff1 [(2048, 512), float32]',
 'encoder.layers.0.ff.ff1 [(2048,), float32]',
 'encoder.layers.0.ff.ff2 [(512, 2048), float32]',
 'encoder.layers.0.ff.ff2 [(512,), float32]',
 'encoder.layers.1.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.1.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.1.self_attention.ff_out [(512, 512), float32]',
 'encoder.layers.1.self_attention.ff_in [(1536, 512), float32]',
 'encoder.layers.1.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.1.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.1.ff.ff1 [(2048, 512), float32]',
 'encoder.layers.1.ff.ff1 [(2048,), float32]',
 'encoder.layers.1.ff.ff2 [(512, 2048), float32]',
 'encoder.layers.1.ff.ff2 [(512,), float32]',
 'encoder.layers.2.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.2.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.2.self_attention.ff_out [(512, 512), float32]',
 'encoder.layers.2.self_attention.ff_in [(1536, 512), float32]',
 'encoder.layers.2.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.2.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.2.ff.ff1 [(2048, 512), float32]',
 'encoder.layers.2.ff.ff1 [(2048,), float32]',
 'encoder.layers.2.ff.ff2 [(512, 2048), float32]',
 'encoder.layers.2.ff.ff2 [(512,), float32]',
 'encoder.layers.3.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.3.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.3.self_attention.ff_out [(512, 512), float32]',
 'encoder.layers.3.self_attention.ff_in [(1536, 512), float32]',
 'encoder.layers.3.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.3.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.3.ff.ff1 [(2048, 512), float32]',
 'encoder.layers.3.ff.ff1 [(2048,), float32]',
 'encoder.layers.3.ff.ff2 [(512, 2048), float32]',
 'encoder.layers.3.ff.ff2 [(512,), float32]',
 'encoder.layers.4.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.4.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.4.self_attention.ff_out [(512, 512), float32]',
 'encoder.layers.4.self_attention.ff_in [(1536, 512), float32]',
 'encoder.layers.4.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.4.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.4.ff.ff1 [(2048, 512), float32]',
 'encoder.layers.4.ff.ff1 [(2048,), float32]',
 'encoder.layers.4.ff.ff2 [(512, 2048), float32]',
 'encoder.layers.4.ff.ff2 [(512,), float32]',
 'encoder.layers.5.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.5.pre_self_attention.layer_norm [(512,), float32]',
 'encoder.layers.5.self_attention.ff_out [(512, 512), float32]',
 'encoder.layers.5.self_attention.ff_in [(1536, 512), float32]',
 'encoder.layers.5.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.5.pre_ff.layer_norm [(512,), float32]',
 'encoder.layers.5.ff.ff1 [(2048, 512), float32]',
 'encoder.layers.5.ff.ff1 [(2048,), float32]',
 'encoder.layers.5.ff.ff2 [(512, 2048), float32]',
 'encoder.layers.5.ff.ff2 [(512,), float32]',
 'encoder.final_process.layer_norm [(512,), float32]',
 'encoder.final_process.layer_norm [(512,), float32]',
 'decoder.layers.0.autoregr_layer.ff_out [(512, 512), float32]',
 'decoder.layers.0.autoregr_layer.ff_in [(1536, 512), float32]',
 'decoder.layers.0.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.0.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.0.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.0.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.0.enc_attention.ff_out [(512, 512), float32]',
 'decoder.layers.0.enc_attention.ff_q [(512, 512), float32]',
 'decoder.layers.0.enc_attention.ff_kv [(1024, 512), float32]',
 'decoder.layers.0.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.0.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.0.ff.ff1 [(2048, 512), float32]',
 'decoder.layers.0.ff.ff1 [(2048,), float32]',
 'decoder.layers.0.ff.ff2 [(512, 2048), float32]',
 'decoder.layers.0.ff.ff2 [(512,), float32]',
 'decoder.layers.1.autoregr_layer.ff_out [(512, 512), float32]',
 'decoder.layers.1.autoregr_layer.ff_in [(1536, 512), float32]',
 'decoder.layers.1.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.1.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.1.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.1.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.1.enc_attention.ff_out [(512, 512), float32]',
 'decoder.layers.1.enc_attention.ff_q [(512, 512), float32]',
 'decoder.layers.1.enc_attention.ff_kv [(1024, 512), float32]',
 'decoder.layers.1.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.1.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.1.ff.ff1 [(2048, 512), float32]',
 'decoder.layers.1.ff.ff1 [(2048,), float32]',
 'decoder.layers.1.ff.ff2 [(512, 2048), float32]',
 'decoder.layers.1.ff.ff2 [(512,), float32]',
 'decoder.layers.2.autoregr_layer.ff_out [(512, 512), float32]',
 'decoder.layers.2.autoregr_layer.ff_in [(1536, 512), float32]',
 'decoder.layers.2.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.2.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.2.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.2.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.2.enc_attention.ff_out [(512, 512), float32]',
 'decoder.layers.2.enc_attention.ff_q [(512, 512), float32]',
 'decoder.layers.2.enc_attention.ff_kv [(1024, 512), float32]',
 'decoder.layers.2.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.2.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.2.ff.ff1 [(2048, 512), float32]',
 'decoder.layers.2.ff.ff1 [(2048,), float32]',
 'decoder.layers.2.ff.ff2 [(512, 2048), float32]',
 'decoder.layers.2.ff.ff2 [(512,), float32]',
 'decoder.layers.3.autoregr_layer.ff_out [(512, 512), float32]',
 'decoder.layers.3.autoregr_layer.ff_in [(1536, 512), float32]',
 'decoder.layers.3.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.3.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.3.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.3.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.3.enc_attention.ff_out [(512, 512), float32]',
 'decoder.layers.3.enc_attention.ff_q [(512, 512), float32]',
 'decoder.layers.3.enc_attention.ff_kv [(1024, 512), float32]',
 'decoder.layers.3.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.3.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.3.ff.ff1 [(2048, 512), float32]',
 'decoder.layers.3.ff.ff1 [(2048,), float32]',
 'decoder.layers.3.ff.ff2 [(512, 2048), float32]',
 'decoder.layers.3.ff.ff2 [(512,), float32]',
 'decoder.layers.4.autoregr_layer.ff_out [(512, 512), float32]',
 'decoder.layers.4.autoregr_layer.ff_in [(1536, 512), float32]',
 'decoder.layers.4.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.4.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.4.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.4.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.4.enc_attention.ff_out [(512, 512), float32]',
 'decoder.layers.4.enc_attention.ff_q [(512, 512), float32]',
 'decoder.layers.4.enc_attention.ff_kv [(1024, 512), float32]',
 'decoder.layers.4.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.4.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.4.ff.ff1 [(2048, 512), float32]',
 'decoder.layers.4.ff.ff1 [(2048,), float32]',
 'decoder.layers.4.ff.ff2 [(512, 2048), float32]',
 'decoder.layers.4.ff.ff2 [(512,), float32]',
 'decoder.layers.5.autoregr_layer.ff_out [(512, 512), float32]',
 'decoder.layers.5.autoregr_layer.ff_in [(1536, 512), float32]',
 'decoder.layers.5.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.5.pre_autoregr_layer.layer_norm [(512,), float32]',
 'decoder.layers.5.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.5.pre_enc_attention.layer_norm [(512,), float32]',
 'decoder.layers.5.enc_attention.ff_out [(512, 512), float32]',
 'decoder.layers.5.enc_attention.ff_q [(512, 512), float32]',
 'decoder.layers.5.enc_attention.ff_kv [(1024, 512), float32]',
 'decoder.layers.5.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.5.pre_ff.layer_norm [(512,), float32]',
 'decoder.layers.5.ff.ff1 [(2048, 512), float32]',
 'decoder.layers.5.ff.ff1 [(2048,), float32]',
 'decoder.layers.5.ff.ff2 [(512, 2048), float32]',
 'decoder.layers.5.ff.ff2 [(512,), float32]',
 'decoder.final_process.layer_norm [(512,), float32]',
 'decoder.final_process.layer_norm [(512,), float32]',
 'output_layer [(1824, 512), float32]',
 'output_layer [(1824,), float32]']
[2022-08-25:15:31:48:INFO:sockeye.utils:log_parameters] Shared parameters: 
['embedding_source.embedding.weight = embedding_target.embedding.weight = output_layer.weight']
[2022-08-25:15:31:48:INFO:sockeye.utils:log_parameters] Fixed parameters:
['encoder.pos_embedding [(96, 512), float32]',
 'decoder.pos_embedding [(96, 512), float32]']
[2022-08-25:15:31:48:INFO:sockeye.loss:__init__] Loss: cross-entropy | weight=1.00 | metric: perplexity (ppl) | output_name: 'logits' | label_name: 'target_label'
[2022-08-25:15:31:48:WARNING:sockeye.optimizers:get_optimizer] Cannot import NVIDIA Apex optimizers (FusedAdam, FusedSGD). Consider installing Apex for faster GPU training: https://github.com/NVIDIA/apex
[2022-08-25:15:31:48:INFO:sockeye.lr_scheduler:__init__] Will reduce the learning rate by a factor of 0.90 whenever the validation score doesn't improve 8 times.
[2022-08-25:15:31:48:INFO:__main__:train] Tracing SockeyeModel on a validation batch
[2022-08-25:15:31:50:INFO:sockeye.training:__init__] Logging training events for Tensorboard at 'de-bar-base-model/tensorboard'
[2022-08-25:15:31:51:INFO:numexpr.utils:_init_num_threads] Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
[2022-08-25:15:31:51:INFO:numexpr.utils:_init_num_threads] NumExpr defaulting to 8 threads.
[2022-08-25:15:31:51:INFO:sockeye.inference:__init__] Translator (1 model(s) beam_size=5 algorithm=BeamSearch, beam_search_stop=all max_input_length=95 nbest_size=1 ensemble_mode=None max_batch_size=16 dtype=torch.float32 skip_nvs=False nvs_thresh=0.5)
[2022-08-25:15:31:51:INFO:sockeye.checkpoint_decoder:__init__] Created CheckpointDecoder(max_input_len=-1, beam_size=5, num_sentences=500)
[2022-08-25:15:31:54:INFO:sockeye.training:fit] Early stopping by optimizing 'perplexity'
[2022-08-25:15:31:54:INFO:sockeye.model:save_config] Saved model config to "de-bar-base-model/config"
[2022-08-25:15:31:56:INFO:root:save_parameters] Saved params/state_dict to "de-bar-base-model/params.00000"
[2022-08-25:15:31:56:INFO:sockeye.training:fit] Training started.
[2022-08-25:15:32:10:INFO:sockeye.training:__call__] E=0 B=50	s/sec=626.02 tok/sec=18982.42 u/sec=3.94	ppl=495.332419 
[2022-08-25:15:32:21:INFO:sockeye.training:__call__] E=0 B=100	s/sec=706.51 tok/sec=21012.68 u/sec=4.39	ppl=435.608022 
[2022-08-25:15:32:32:INFO:sockeye.training:__call__] E=0 B=150	s/sec=655.91 tok/sec=20843.22 u/sec=4.38	ppl=387.011719 
[2022-08-25:15:32:44:INFO:sockeye.training:__call__] E=0 B=200	s/sec=704.61 tok/sec=20515.06 u/sec=4.28	ppl=341.200078 
[2022-08-25:15:32:56:INFO:sockeye.training:__call__] E=1 B=250	s/sec=625.72 tok/sec=20261.91 u/sec=4.24	ppl=306.862677 
[2022-08-25:15:33:08:INFO:sockeye.training:__call__] E=1 B=300	s/sec=634.36 tok/sec=19173.56 u/sec=4.02	ppl=277.895307 
[2022-08-25:15:33:21:INFO:sockeye.training:__call__] E=1 B=350	s/sec=698.82 tok/sec=19333.30 u/sec=4.01	ppl=254.004537 
[2022-08-25:15:33:33:INFO:sockeye.training:__call__] E=1 B=400	s/sec=650.44 tok/sec=19279.63 u/sec=4.01	ppl=231.943331 
[2022-08-25:15:33:46:INFO:sockeye.training:__call__] E=2 B=450	s/sec=652.99 tok/sec=19263.88 u/sec=4.01	ppl=208.044517 
[2022-08-25:15:33:58:INFO:sockeye.training:__call__] E=2 B=500	s/sec=605.16 tok/sec=19176.52 u/sec=3.98	ppl=185.029093 
[2022-08-25:15:34:10:INFO:sockeye.training:__call__] E=2 B=550	s/sec=641.20 tok/sec=20220.95 u/sec=4.23	ppl=164.551958 
[2022-08-25:15:34:22:INFO:sockeye.training:__call__] E=2 B=600	s/sec=669.41 tok/sec=19715.16 u/sec=4.13	ppl=146.551005 
[2022-08-25:15:34:34:INFO:sockeye.training:__call__] E=2 B=650	s/sec=634.08 tok/sec=19678.19 u/sec=4.12	ppl=131.121641 
[2022-08-25:15:34:47:INFO:sockeye.training:__call__] E=3 B=700	s/sec=628.37 tok/sec=19124.94 u/sec=4.00	ppl=118.035845 
[2022-08-25:15:34:59:INFO:sockeye.training:__call__] E=3 B=750	s/sec=705.67 tok/sec=19048.61 u/sec=3.95	ppl=106.996506 
[2022-08-25:15:35:12:INFO:sockeye.training:__call__] E=3 B=800	s/sec=666.32 tok/sec=19170.49 u/sec=3.99	ppl=97.348918 
[2022-08-25:15:35:24:INFO:sockeye.training:__call__] E=3 B=850	s/sec=564.45 tok/sec=19866.48 u/sec=4.19	ppl=89.094389 
[2022-08-25:15:35:36:INFO:sockeye.training:__call__] E=4 B=900	s/sec=644.19 tok/sec=19357.83 u/sec=4.02	ppl=81.776755 
[2022-08-25:15:35:49:INFO:sockeye.training:__call__] E=4 B=950	s/sec=623.16 tok/sec=19029.16 u/sec=4.00	ppl=75.244026 
[2022-08-25:15:36:01:INFO:sockeye.training:__call__] E=4 B=1000	s/sec=596.47 tok/sec=19122.93 u/sec=4.00	ppl=69.425973 
[2022-08-25:15:36:14:INFO:sockeye.training:__call__] E=4 B=1050	s/sec=723.81 tok/sec=19115.24 u/sec=3.94	ppl=64.502032 
[2022-08-25:15:36:27:INFO:sockeye.training:__call__] E=4 B=1100	s/sec=612.27 tok/sec=19063.67 u/sec=3.97	ppl=60.065524 
[2022-08-25:15:36:39:INFO:sockeye.training:__call__] E=5 B=1150	s/sec=591.80 tok/sec=19121.91 u/sec=4.00	ppl=56.082204 
[2022-08-25:15:36:52:INFO:sockeye.training:__call__] E=5 B=1200	s/sec=675.59 tok/sec=19091.48 u/sec=3.96	ppl=52.573458 
[2022-08-25:15:37:04:INFO:sockeye.training:__call__] E=5 B=1250	s/sec=588.19 tok/sec=19077.48 u/sec=3.99	ppl=49.513912 
[2022-08-25:15:37:17:INFO:sockeye.training:__call__] E=5 B=1300	s/sec=698.11 tok/sec=19086.39 u/sec=3.98	ppl=46.849744 
[2022-08-25:15:37:29:INFO:sockeye.training:__call__] E=6 B=1350	s/sec=608.32 tok/sec=19046.32 u/sec=3.95	ppl=44.385228 
[2022-08-25:15:37:42:INFO:sockeye.training:__call__] E=6 B=1400	s/sec=645.48 tok/sec=18966.36 u/sec=3.97	ppl=42.216546 
[2022-08-25:15:37:55:INFO:sockeye.training:__call__] E=6 B=1450	s/sec=617.26 tok/sec=19051.13 u/sec=4.00	ppl=40.242977 
[2022-08-25:15:38:07:INFO:sockeye.training:__call__] E=6 B=1500	s/sec=599.98 tok/sec=19055.24 u/sec=4.02	ppl=38.443791 
[2022-08-25:15:38:20:INFO:sockeye.training:__call__] E=7 B=1550	s/sec=704.55 tok/sec=19149.66 u/sec=3.94	ppl=36.859130 
[2022-08-25:15:38:32:INFO:sockeye.training:__call__] E=7 B=1600	s/sec=641.92 tok/sec=19111.15 u/sec=3.98	ppl=35.383441 
[2022-08-25:15:38:45:INFO:sockeye.training:__call__] E=7 B=1650	s/sec=593.39 tok/sec=18988.34 u/sec=4.02	ppl=34.030618 
[2022-08-25:15:38:57:INFO:sockeye.training:__call__] E=7 B=1700	s/sec=640.78 tok/sec=19538.80 u/sec=4.06	ppl=32.800328 
[2022-08-25:15:39:10:INFO:sockeye.training:__call__] E=7 B=1750	s/sec=642.78 tok/sec=19069.38 u/sec=3.96	ppl=31.645011 
[2022-08-25:15:39:22:INFO:sockeye.training:__call__] E=8 B=1800	s/sec=690.38 tok/sec=19234.64 u/sec=3.95	ppl=30.597672 
[2022-08-25:15:39:35:INFO:sockeye.training:__call__] E=8 B=1850	s/sec=613.74 tok/sec=18983.60 u/sec=4.00	ppl=29.614371 
[2022-08-25:15:39:47:INFO:sockeye.training:__call__] E=8 B=1900	s/sec=613.86 tok/sec=19022.73 u/sec=3.98	ppl=28.708897 
[2022-08-25:15:40:00:INFO:sockeye.training:__call__] E=8 B=1950	s/sec=603.60 tok/sec=19599.12 u/sec=4.11	ppl=27.845388 
[2022-08-25:15:40:12:INFO:sockeye.training:__call__] E=9 B=2000	s/sec=624.02 tok/sec=19280.74 u/sec=4.04	ppl=27.075941 
[2022-08-25:15:40:25:INFO:sockeye.training:__call__] E=9 B=2050	s/sec=729.94 tok/sec=19135.93 u/sec=3.94	ppl=26.335832 
[2022-08-25:15:40:37:INFO:sockeye.training:__call__] E=9 B=2100	s/sec=612.62 tok/sec=19064.94 u/sec=4.01	ppl=25.630028 
[2022-08-25:15:40:50:INFO:sockeye.training:__call__] E=9 B=2150	s/sec=638.52 tok/sec=18983.98 u/sec=3.97	ppl=25.011200 
[2022-08-25:15:41:02:INFO:sockeye.training:__call__] E=9 B=2200	s/sec=581.37 tok/sec=19056.12 u/sec=3.97	ppl=24.403947 
[2022-08-25:15:41:15:INFO:sockeye.training:__call__] E=10 B=2250	s/sec=551.29 tok/sec=18995.21 u/sec=4.01	ppl=23.808931 
[2022-08-25:15:41:27:INFO:sockeye.training:__call__] E=10 B=2300	s/sec=638.61 tok/sec=18924.92 u/sec=3.99	ppl=23.276510 
[2022-08-25:15:41:40:INFO:sockeye.training:__call__] E=10 B=2350	s/sec=637.41 tok/sec=19023.36 u/sec=3.96	ppl=22.771446 
[2022-08-25:15:41:53:INFO:sockeye.training:__call__] E=10 B=2400	s/sec=664.80 tok/sec=19115.97 u/sec=3.94	ppl=22.283902 
[2022-08-25:15:42:05:INFO:sockeye.training:__call__] E=11 B=2450	s/sec=641.14 tok/sec=19135.79 u/sec=4.00	ppl=21.825304 
[2022-08-25:15:42:17:INFO:sockeye.training:__call__] E=11 B=2500	s/sec=622.26 tok/sec=19410.39 u/sec=4.09	ppl=21.382425 
[2022-08-25:15:42:30:INFO:sockeye.training:__call__] E=11 B=2550	s/sec=647.76 tok/sec=19541.22 u/sec=4.09	ppl=20.970265 
[2022-08-25:15:42:42:INFO:sockeye.training:__call__] E=11 B=2600	s/sec=706.77 tok/sec=19321.24 u/sec=4.00	ppl=20.579268 
[2022-08-25:15:42:55:INFO:sockeye.training:__call__] E=12 B=2650	s/sec=623.28 tok/sec=19403.39 u/sec=4.03	ppl=20.196654 
[2022-08-25:15:43:07:INFO:sockeye.training:__call__] E=12 B=2700	s/sec=606.27 tok/sec=19018.60 u/sec=3.98	ppl=19.831612 
[2022-08-25:15:43:20:INFO:sockeye.training:__call__] E=12 B=2750	s/sec=604.62 tok/sec=19089.26 u/sec=3.96	ppl=19.484878 
[2022-08-25:15:43:32:INFO:sockeye.training:__call__] E=12 B=2800	s/sec=661.18 tok/sec=19082.76 u/sec=3.97	ppl=19.152377 
[2022-08-25:15:43:45:INFO:sockeye.training:__call__] E=12 B=2850	s/sec=654.44 tok/sec=19579.60 u/sec=4.09	ppl=18.842883 
[2022-08-25:15:43:57:INFO:sockeye.training:__call__] E=13 B=2900	s/sec=588.70 tok/sec=19018.81 u/sec=4.03	ppl=18.528605 
[2022-08-25:15:44:10:INFO:sockeye.training:__call__] E=13 B=2950	s/sec=684.83 tok/sec=19099.50 u/sec=3.95	ppl=18.233640 
[2022-08-25:15:44:22:INFO:sockeye.training:__call__] E=13 B=3000	s/sec=544.29 tok/sec=19201.82 u/sec=4.06	ppl=17.948858 
[2022-08-25:15:44:34:INFO:sockeye.training:__call__] E=13 B=3050	s/sec=663.64 tok/sec=19358.56 u/sec=4.03	ppl=17.694006 
[2022-08-25:15:44:47:INFO:sockeye.training:__call__] E=14 B=3100	s/sec=770.54 tok/sec=19242.67 u/sec=3.96	ppl=17.442980 
[2022-08-25:15:44:59:INFO:sockeye.training:__call__] E=14 B=3150	s/sec=632.05 tok/sec=19290.63 u/sec=4.04	ppl=17.190549 
[2022-08-25:15:45:12:INFO:sockeye.training:__call__] E=14 B=3200	s/sec=607.59 tok/sec=19112.04 u/sec=3.98	ppl=16.944410 
[2022-08-25:15:45:24:INFO:sockeye.training:__call__] E=14 B=3250	s/sec=711.23 tok/sec=19479.41 u/sec=4.00	ppl=16.716415 
[2022-08-25:15:45:37:INFO:sockeye.training:__call__] E=14 B=3300	s/sec=550.15 tok/sec=18975.59 u/sec=4.03	ppl=16.495226 
[2022-08-25:15:45:49:INFO:sockeye.training:__call__] E=15 B=3350	s/sec=676.87 tok/sec=19077.41 u/sec=3.99	ppl=16.267190 
[2022-08-25:15:46:02:INFO:sockeye.training:__call__] E=15 B=3400	s/sec=581.05 tok/sec=18988.22 u/sec=4.00	ppl=16.054988 
[2022-08-25:15:46:15:INFO:sockeye.training:__call__] E=15 B=3450	s/sec=692.10 tok/sec=19220.43 u/sec=3.93	ppl=15.854128 
[2022-08-25:15:46:27:INFO:sockeye.training:__call__] E=15 B=3500	s/sec=593.48 tok/sec=19036.81 u/sec=3.95	ppl=15.659459 
[2022-08-25:15:46:40:INFO:sockeye.training:__call__] E=16 B=3550	s/sec=656.96 tok/sec=19034.66 u/sec=3.98	ppl=15.466158 
[2022-08-25:15:46:52:INFO:sockeye.training:__call__] E=16 B=3600	s/sec=548.27 tok/sec=18996.37 u/sec=4.02	ppl=15.271653 
[2022-08-25:15:47:05:INFO:sockeye.training:__call__] E=16 B=3650	s/sec=709.07 tok/sec=19137.70 u/sec=4.01	ppl=15.093738 
[2022-08-25:15:47:17:INFO:sockeye.training:__call__] E=16 B=3700	s/sec=587.44 tok/sec=19197.87 u/sec=4.00	ppl=14.920693 
[2022-08-25:15:47:29:INFO:sockeye.training:__call__] E=17 B=3750	s/sec=669.11 tok/sec=19715.82 u/sec=4.08	ppl=14.753912 
[2022-08-25:15:47:42:INFO:sockeye.training:__call__] E=17 B=3800	s/sec=785.34 tok/sec=19309.25 u/sec=3.96	ppl=14.587965 
[2022-08-25:15:47:55:INFO:sockeye.training:__call__] E=17 B=3850	s/sec=572.09 tok/sec=19010.92 u/sec=3.99	ppl=14.419603 
[2022-08-25:15:48:07:INFO:sockeye.training:__call__] E=17 B=3900	s/sec=570.17 tok/sec=19112.35 u/sec=4.03	ppl=14.264346 
[2022-08-25:15:48:19:INFO:sockeye.training:__call__] E=17 B=3950	s/sec=649.32 tok/sec=19710.87 u/sec=4.13	ppl=14.115988 
[2022-08-25:15:48:32:INFO:sockeye.training:__call__] E=18 B=4000	s/sec=671.11 tok/sec=18971.06 u/sec=3.96	ppl=13.964550 
[2022-08-25:15:48:32:INFO:sockeye.training:_create_checkpoint] Checkpoint [1]	Updates=4000 Epoch=18 Samples=636768 Time-cost=995.902 Updates/sec=4.016
[2022-08-25:15:48:32:INFO:sockeye.training:_create_checkpoint] Checkpoint [1]	Train-ppl=13.964550
[2022-08-25:15:48:48:INFO:sockeye.training:_evaluate] Checkpoint [1]	Validation-ppl=10.195087	Validation-bleu=0.621548	Validation-chrf=0.749107	Validation-rouge1=0.666452	Validation-rouge2=0.591013	Validation-rougel=0.643680	Validation-length-ratio-mse=1.005736	Validation-ter=0.348754	Validation-avg-sec-per-sent=0.013673	Validation-decode-walltime=6.836396
[2022-08-25:15:48:48:INFO:sockeye.training:_determine_improvement] Validation-perplexity improved to 10.195087 (delta=inf).
[2022-08-25:15:48:48:INFO:sockeye.training:_determine_convergence] Sufficient improvement to continue: inf > 0.000000 over 1 checkpoints
[2022-08-25:15:48:48:INFO:sockeye.training:_adjust_learning_rate] Checkpoint [1]	Learning-rate=0.000200
[2022-08-25:15:48:51:INFO:sockeye.training:_save_optimizer_state] Saved optimizer state to "de-bar-base-model/tmp.training_state/optimizer_last.pkl"
[2022-08-25:15:48:51:INFO:sockeye.training:_save_lr_scheduler] Saved 'LearningRateSchedulerPlateauReduce(reduce_factor=0.90, reduce_num_not_improved=8, num_not_improved=0, base_lr=0.0002, lr=0.0002, warmup=0, warmed_up=True)' to 'de-bar-base-model/tmp.training_state/lr_scheduler_last.pkl'
[2022-08-25:15:48:53:INFO:root:save_parameters] Saved params/state_dict to "de-bar-base-model/params.00001"
[2022-08-25:15:48:53:INFO:sockeye.training:_update_best_params] 'de-bar-base-model/params.best' now points to 'params.00001'
[2022-08-25:15:48:57:INFO:sockeye.training:_save_optimizer_state] Saved optimizer state to "de-bar-base-model/optimizer_best.pkl"
[2022-08-25:15:48:57:INFO:sockeye.training:_save_lr_scheduler] Saved 'LearningRateSchedulerPlateauReduce(reduce_factor=0.90, reduce_num_not_improved=8, num_not_improved=0, base_lr=0.0002, lr=0.0002, warmup=0, warmed_up=True)' to 'de-bar-base-model/lr_scheduler_best.pkl'
[2022-08-25:15:49:08:INFO:sockeye.training:__call__] E=18 B=4050	s/sec=234.69 tok/sec=6594.00 u/sec=1.37	ppl=6.004237 
[2022-08-25:15:49:20:INFO:sockeye.training:__call__] E=18 B=4100	s/sec=605.47 tok/sec=19938.13 u/sec=4.19	ppl=5.895934 
[2022-08-25:15:49:33:INFO:sockeye.training:__call__] E=18 B=4150	s/sec=632.87 tok/sec=19373.64 u/sec=4.04	ppl=5.923861 
[2022-08-25:15:49:45:INFO:sockeye.training:__call__] E=19 B=4200	s/sec=636.31 tok/sec=19124.70 u/sec=3.96	ppl=5.906865 
[2022-08-25:15:49:58:INFO:sockeye.training:__call__] E=19 B=4250	s/sec=722.29 tok/sec=19112.25 u/sec=3.97	ppl=5.873920 
[2022-08-25:15:50:10:INFO:sockeye.training:__call__] E=19 B=4300	s/sec=598.77 tok/sec=19362.66 u/sec=4.05	ppl=5.824812 
[2022-08-25:15:50:23:INFO:sockeye.training:__call__] E=19 B=4350	s/sec=610.59 tok/sec=19060.07 u/sec=3.94	ppl=5.812468 
[2022-08-25:15:50:35:INFO:sockeye.training:__call__] E=19 B=4400	s/sec=563.64 tok/sec=18876.61 u/sec=4.03	ppl=5.812917 
[2022-08-25:15:50:48:INFO:sockeye.training:__call__] E=20 B=4450	s/sec=625.00 tok/sec=18974.47 u/sec=3.97	ppl=5.761927 
[2022-08-25:15:51:00:INFO:sockeye.training:__call__] E=20 B=4500	s/sec=665.44 tok/sec=19045.26 u/sec=3.98	ppl=5.738457 
[2022-08-25:15:51:13:INFO:sockeye.training:__call__] E=20 B=4550	s/sec=680.74 tok/sec=18992.79 u/sec=3.94	ppl=5.740041 
[2022-08-25:15:51:26:INFO:sockeye.training:__call__] E=20 B=4600	s/sec=562.50 tok/sec=19053.43 u/sec=4.00	ppl=5.711969 
[2022-08-25:15:51:38:INFO:sockeye.training:__call__] E=21 B=4650	s/sec=653.85 tok/sec=19182.91 u/sec=3.98	ppl=5.683698 
[2022-08-25:15:51:51:INFO:sockeye.training:__call__] E=21 B=4700	s/sec=704.41 tok/sec=19232.40 u/sec=3.93	ppl=5.663005 
[2022-08-25:15:52:03:INFO:sockeye.training:__call__] E=21 B=4750	s/sec=623.72 tok/sec=18968.35 u/sec=3.99	ppl=5.640928 
[2022-08-25:15:52:16:INFO:sockeye.training:__call__] E=21 B=4800	s/sec=577.48 tok/sec=19022.38 u/sec=4.00	ppl=5.627658 
[2022-08-25:15:52:28:INFO:sockeye.training:__call__] E=22 B=4850	s/sec=566.64 tok/sec=19012.25 u/sec=4.04	ppl=5.600831 
[2022-08-25:15:52:41:INFO:sockeye.training:__call__] E=22 B=4900	s/sec=595.53 tok/sec=18980.47 u/sec=3.99	ppl=5.571570 
[2022-08-25:15:52:53:INFO:sockeye.training:__call__] E=22 B=4950	s/sec=622.65 tok/sec=19107.24 u/sec=3.99	ppl=5.549646 
[2022-08-25:15:53:06:INFO:sockeye.training:__call__] E=22 B=5000	s/sec=649.57 tok/sec=19077.68 u/sec=3.96	ppl=5.530306 
[2022-08-25:15:53:19:INFO:sockeye.training:__call__] E=22 B=5050	s/sec=705.88 tok/sec=19068.09 u/sec=3.93	ppl=5.518628 
[2022-08-25:15:53:31:INFO:sockeye.training:__call__] E=23 B=5100	s/sec=569.25 tok/sec=19039.91 u/sec=4.00	ppl=5.489495 
[2022-08-25:15:53:44:INFO:sockeye.training:__call__] E=23 B=5150	s/sec=689.54 tok/sec=18939.15 u/sec=3.96	ppl=5.466520 
[2022-08-25:15:53:56:INFO:sockeye.training:__call__] E=23 B=5200	s/sec=619.81 tok/sec=19111.80 u/sec=4.00	ppl=5.444311 
[2022-08-25:15:54:09:INFO:sockeye.training:__call__] E=23 B=5250	s/sec=642.70 tok/sec=19020.51 u/sec=3.93	ppl=5.430921 
[2022-08-25:15:54:22:INFO:sockeye.training:__call__] E=24 B=5300	s/sec=575.14 tok/sec=19090.90 u/sec=4.00	ppl=5.410110 
[2022-08-25:15:54:34:INFO:sockeye.training:__call__] E=24 B=5350	s/sec=675.72 tok/sec=19152.08 u/sec=3.94	ppl=5.387408 
[2022-08-25:15:54:47:INFO:sockeye.training:__call__] E=24 B=5400	s/sec=642.29 tok/sec=18965.77 u/sec=4.03	ppl=5.366271 
[2022-08-25:15:54:59:INFO:sockeye.training:__call__] E=24 B=5450	s/sec=589.19 tok/sec=19032.58 u/sec=3.98	ppl=5.350023 
[2022-08-25:15:55:11:INFO:sockeye.training:__call__] E=24 B=5500	s/sec=699.54 tok/sec=20015.50 u/sec=4.13	ppl=5.335643 
[2022-08-25:15:55:24:INFO:sockeye.training:__call__] E=25 B=5550	s/sec=598.91 tok/sec=19108.18 u/sec=4.03	ppl=5.310546 
[2022-08-25:15:55:36:INFO:sockeye.training:__call__] E=25 B=5600	s/sec=721.64 tok/sec=19126.29 u/sec=3.93	ppl=5.291626 
[2022-08-25:15:55:49:INFO:sockeye.training:__call__] E=25 B=5650	s/sec=587.43 tok/sec=19093.61 u/sec=3.99	ppl=5.271395 
[2022-08-25:15:56:01:INFO:sockeye.training:__call__] E=25 B=5700	s/sec=681.05 tok/sec=19297.99 u/sec=4.01	ppl=5.259683 
[2022-08-25:15:56:14:INFO:sockeye.training:__call__] E=26 B=5750	s/sec=518.26 tok/sec=19229.09 u/sec=4.12	ppl=5.238159 
[2022-08-25:15:56:26:INFO:sockeye.training:__call__] E=26 B=5800	s/sec=594.61 tok/sec=19006.89 u/sec=4.00	ppl=5.215005 
[2022-08-25:15:56:39:INFO:sockeye.training:__call__] E=26 B=5850	s/sec=629.06 tok/sec=19000.39 u/sec=3.94	ppl=5.198039 
[2022-08-25:15:56:51:INFO:sockeye.training:__call__] E=26 B=5900	s/sec=723.21 tok/sec=19180.52 u/sec=3.97	ppl=5.184378 
[2022-08-25:15:57:04:INFO:sockeye.training:__call__] E=27 B=5950	s/sec=650.82 tok/sec=19258.58 u/sec=3.98	ppl=5.169605 
[2022-08-25:15:57:17:INFO:sockeye.training:__call__] E=27 B=6000	s/sec=678.44 tok/sec=19046.86 u/sec=3.94	ppl=5.148896 
[2022-08-25:15:57:29:INFO:sockeye.training:__call__] E=27 B=6050	s/sec=655.56 tok/sec=19097.96 u/sec=3.96	ppl=5.131778 
[2022-08-25:15:57:42:INFO:sockeye.training:__call__] E=27 B=6100	s/sec=687.64 tok/sec=19261.52 u/sec=4.01	ppl=5.117675 
[2022-08-25:15:57:54:INFO:sockeye.training:__call__] E=27 B=6150	s/sec=527.93 tok/sec=19120.03 u/sec=4.06	ppl=5.101957 
[2022-08-25:15:58:07:INFO:sockeye.training:__call__] E=28 B=6200	s/sec=640.68 tok/sec=19116.45 u/sec=3.96	ppl=5.082868 
[2022-08-25:15:58:19:INFO:sockeye.training:__call__] E=28 B=6250	s/sec=580.94 tok/sec=19053.92 u/sec=3.98	ppl=5.064865 
[2022-08-25:15:58:31:INFO:sockeye.training:__call__] E=28 B=6300	s/sec=612.77 tok/sec=19724.87 u/sec=4.13	ppl=5.048361 
[2022-08-25:15:58:44:INFO:sockeye.training:__call__] E=28 B=6350	s/sec=765.64 tok/sec=18978.41 u/sec=3.93	ppl=5.037415 
[2022-08-25:15:58:57:INFO:sockeye.training:__call__] E=29 B=6400	s/sec=594.39 tok/sec=19071.87 u/sec=4.02	ppl=5.022190 
[2022-08-25:15:59:09:INFO:sockeye.training:__call__] E=29 B=6450	s/sec=692.50 tok/sec=19198.67 u/sec=3.93	ppl=5.005483 
[2022-08-25:15:59:22:INFO:sockeye.training:__call__] E=29 B=6500	s/sec=590.58 tok/sec=18944.73 u/sec=4.01	ppl=4.989410 
[2022-08-25:15:59:34:INFO:sockeye.training:__call__] E=29 B=6550	s/sec=637.65 tok/sec=19187.38 u/sec=4.03	ppl=4.975549 
[2022-08-25:15:59:47:INFO:sockeye.training:__call__] E=29 B=6600	s/sec=593.90 tok/sec=19060.86 u/sec=3.98	ppl=4.962117 
[2022-08-25:15:59:59:INFO:sockeye.training:__call__] E=30 B=6650	s/sec=701.60 tok/sec=19460.02 u/sec=4.06	ppl=4.944793 
[2022-08-25:16:00:12:INFO:sockeye.training:__call__] E=30 B=6700	s/sec=587.18 tok/sec=19061.04 u/sec=4.00	ppl=4.929195 
[2022-08-25:16:00:24:INFO:sockeye.training:__call__] E=30 B=6750	s/sec=583.94 tok/sec=19017.83 u/sec=3.99	ppl=4.914658 
[2022-08-25:16:00:37:INFO:sockeye.training:__call__] E=30 B=6800	s/sec=587.83 tok/sec=19200.20 u/sec=4.01	ppl=4.902014 
[2022-08-25:16:00:49:INFO:sockeye.training:__call__] E=31 B=6850	s/sec=723.94 tok/sec=19729.23 u/sec=4.12	ppl=4.888545 
[2022-08-25:16:01:01:INFO:sockeye.training:__call__] E=31 B=6900	s/sec=587.98 tok/sec=19060.44 u/sec=3.99	ppl=4.872844 
[2022-08-25:16:01:13:INFO:sockeye.training:__call__] E=31 B=6950	s/sec=586.96 tok/sec=19552.89 u/sec=4.15	ppl=4.858397 
[2022-08-25:16:01:26:INFO:sockeye.training:__call__] E=31 B=7000	s/sec=711.40 tok/sec=19116.25 u/sec=3.97	ppl=4.846967 
[2022-08-25:16:01:39:INFO:sockeye.training:__call__] E=32 B=7050	s/sec=705.14 tok/sec=19084.51 u/sec=3.87	ppl=4.835306 
[2022-08-25:16:01:51:INFO:sockeye.training:__call__] E=32 B=7100	s/sec=609.37 tok/sec=18934.32 u/sec=3.98	ppl=4.820595 
[2022-08-25:16:02:04:INFO:sockeye.training:__call__] E=32 B=7150	s/sec=648.39 tok/sec=19570.82 u/sec=4.09	ppl=4.806974 
[2022-08-25:16:02:16:INFO:sockeye.training:__call__] E=32 B=7200	s/sec=674.22 tok/sec=19122.52 u/sec=3.93	ppl=4.794931 
[2022-08-25:16:02:29:INFO:sockeye.training:__call__] E=32 B=7250	s/sec=609.75 tok/sec=19031.72 u/sec=3.99	ppl=4.783746 
[2022-08-25:16:02:41:INFO:sockeye.training:__call__] E=33 B=7300	s/sec=627.54 tok/sec=19208.73 u/sec=3.99	ppl=4.769848 
[2022-08-25:16:02:54:INFO:sockeye.training:__call__] E=33 B=7350	s/sec=637.91 tok/sec=19057.24 u/sec=3.97	ppl=4.756912 
[2022-08-25:16:03:07:INFO:sockeye.training:__call__] E=33 B=7400	s/sec=648.48 tok/sec=19032.25 u/sec=3.94	ppl=4.745192 
[2022-08-25:16:03:19:INFO:sockeye.training:__call__] E=33 B=7450	s/sec=623.72 tok/sec=18898.50 u/sec=4.00	ppl=4.734248 
[2022-08-25:16:03:32:INFO:sockeye.training:__call__] E=34 B=7500	s/sec=642.33 tok/sec=18990.95 u/sec=3.98	ppl=4.722839 
[2022-08-25:16:03:44:INFO:sockeye.training:__call__] E=34 B=7550	s/sec=664.12 tok/sec=19010.75 u/sec=3.93	ppl=4.710608 
[2022-08-25:16:03:57:INFO:sockeye.training:__call__] E=34 B=7600	s/sec=592.88 tok/sec=19146.53 u/sec=4.01	ppl=4.698529 
[2022-08-25:16:04:09:INFO:sockeye.training:__call__] E=34 B=7650	s/sec=638.97 tok/sec=19042.34 u/sec=3.96	ppl=4.687803 
[2022-08-25:16:04:22:INFO:sockeye.training:__call__] E=34 B=7700	s/sec=590.09 tok/sec=19177.64 u/sec=4.04	ppl=4.677951 
[2022-08-25:16:04:34:INFO:sockeye.training:__call__] E=35 B=7750	s/sec=655.49 tok/sec=19185.07 u/sec=4.01	ppl=4.665799 
[2022-08-25:16:04:47:INFO:sockeye.training:__call__] E=35 B=7800	s/sec=573.55 tok/sec=18982.80 u/sec=4.00	ppl=4.654446 
[2022-08-25:16:05:00:INFO:sockeye.training:__call__] E=35 B=7850	s/sec=728.75 tok/sec=19129.49 u/sec=3.89	ppl=4.644080 
[2022-08-25:16:05:12:INFO:sockeye.training:__call__] E=35 B=7900	s/sec=635.87 tok/sec=18994.50 u/sec=3.99	ppl=4.634540 
[2022-08-25:16:05:25:INFO:sockeye.training:__call__] E=36 B=7950	s/sec=565.86 tok/sec=19060.21 u/sec=4.02	ppl=4.623455 
[2022-08-25:16:05:37:INFO:sockeye.training:__call__] E=36 B=8000	s/sec=663.95 tok/sec=19038.35 u/sec=3.93	ppl=4.612624 
[2022-08-25:16:05:37:INFO:sockeye.training:_create_checkpoint] Checkpoint [2]	Updates=8000 Epoch=36 Samples=1272600 Time-cost=1000.721 Updates/sec=3.997
[2022-08-25:16:05:37:INFO:sockeye.training:_create_checkpoint] Checkpoint [2]	Train-ppl=4.612624
[2022-08-25:16:05:53:INFO:sockeye.training:_evaluate] Checkpoint [2]	Validation-ppl=12.301912	Validation-bleu=0.628814	Validation-chrf=0.751362	Validation-rouge1=0.661749	Validation-rouge2=0.585634	Validation-rougel=0.637593	Validation-length-ratio-mse=1.009886	Validation-ter=0.342099	Validation-avg-sec-per-sent=0.011927	Validation-decode-walltime=5.963614
[2022-08-25:16:05:53:INFO:sockeye.training:_determine_improvement] Validation-perplexity has not improved for 1 checkpoints, best so far: 10.195087
[2022-08-25:16:05:53:INFO:sockeye.training:_determine_convergence] Maximum number of not improved checkpoints reached: improvement 0.000000 <= 0.000000 over 1 checkpoints
[2022-08-25:16:05:53:INFO:sockeye.training:_adjust_learning_rate] Checkpoint [2]	Learning-rate=0.000200
[2022-08-25:16:05:56:INFO:sockeye.training:_save_optimizer_state] Saved optimizer state to "de-bar-base-model/tmp.training_state/optimizer_last.pkl"
[2022-08-25:16:05:56:INFO:sockeye.training:_save_lr_scheduler] Saved 'LearningRateSchedulerPlateauReduce(reduce_factor=0.90, reduce_num_not_improved=8, num_not_improved=1, base_lr=0.0002, lr=0.0002, warmup=0, warmed_up=True)' to 'de-bar-base-model/tmp.training_state/lr_scheduler_last.pkl'
[2022-08-25:16:05:58:INFO:root:save_parameters] Saved params/state_dict to "de-bar-base-model/params.00002"
[2022-08-25:16:05:58:INFO:sockeye.training:fit] Training finished. Best checkpoint: 1. Best validation perplexity: 10.195087
